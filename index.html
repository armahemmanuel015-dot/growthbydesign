<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrowthByDesign | Login</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #00f2ff;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.1);
        }

        body { 
            margin: 0; 
            background: #05070a; 
            color: white; 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            overflow: hidden; 
            height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
        }

        #canvas-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }

        .auth-card { 
            position: relative;
            z-index: 10;
            background: rgba(10, 12, 16, 0.6); 
            padding: 50px 40px; 
            border-radius: 32px; 
            border: 1px solid var(--border); 
            width: 360px; 
            backdrop-filter: blur(30px);
            box-shadow: 0 40px 100px rgba(0,0,0,0.8);
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .auth-card:hover { transform: scale(1.02); }

        h2 { margin-bottom: 25px; font-weight: 800; letter-spacing: -2px; font-size: 2rem; }

        .input-group { margin-bottom: 15px; }

        input { 
            width: 100%; padding: 14px; margin: 8px 0; 
            border-radius: 12px; border: 1px solid #222; 
            background: rgba(0,0,0,0.4); color: white; 
            box-sizing: border-box; outline: none; 
            transition: 0.3s;
        }

        input:focus { border-color: var(--accent); box-shadow: 0 0 15px rgba(0, 242, 255, 0.2); }

        button { 
            width: 100%; padding: 14px; border-radius: 12px; 
            border: none; background: var(--accent); 
            color: #000; font-weight: 800; cursor: pointer; 
            margin-top: 20px; transition: 0.3s; 
        }

        button:hover { 
            background: white; 
            transform: translateY(-3px); 
            box-shadow: 0 10px 20px rgba(0, 242, 255, 0.3); 
        }

        .toggle { 
            font-size: 0.85rem; margin-top: 25px; 
            cursor: pointer; color: #888; text-align: center; 
            transition: 0.3s;
        }
        .toggle:hover { color: var(--accent); }

        /* Smooth UI transitions */
        #signup-fields { transition: max-height 0.5s ease, opacity 0.5s ease; overflow: hidden; }
        .hidden { max-height: 0; opacity: 0; margin-bottom: 0; }
        .visible { max-height: 100px; opacity: 1; margin-bottom: 15px; }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div class="auth-card">
        <h2 id="title">GBD Login</h2>
        <div id="signup-fields" class="hidden">
            <input type="text" id="username" placeholder="Your Elite Callsign">
        </div>
        <div class="input-group">
            <input type="email" id="email" placeholder="Email Address">
            <input type="password" id="password" placeholder="Secure Password">
        </div>
        <button onclick="handleAuth()" id="auth-btn">Authorize</button>
        <div class="toggle" id="toggleText" onclick="toggleMode()">New to the GBD? Create an Account</div>
    </div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- THREE.JS ENGINE ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        // Particle System Properties
        const particleCount = 4000;
        const positions = new Float32Array(particleCount * 3);
        const targetPositions = new Float32Array(particleCount * 3);
        const colors = new Float32Array(particleCount * 3);
        
        const geometry = new THREE.BufferGeometry();
        const material = new THREE.PointsMaterial({
            size: 0.02,
            vertexColors: true,
            transparent: true,
            blending: THREE.AdditiveBlending
        });

        const points = new THREE.Points(geometry, material);
        scene.add(points);
        camera.position.z = 5;

        // Shape Templates
        const createSphere = (arr) => {
            for(let i=0; i<particleCount; i++){
                const phi = Math.acos(-1 + (2 * i) / particleCount);
                const theta = Math.sqrt(particleCount * Math.PI) * phi;
                arr[i*3] = 2 * Math.cos(theta) * Math.sin(phi);
                arr[i*3+1] = 2 * Math.sin(theta) * Math.sin(phi);
                arr[i*3+2] = 2 * Math.cos(phi);
            }
        };

        const createSaturn = (arr) => {
            for(let i=0; i<particleCount; i++){
                if(i < particleCount * 0.6) { // Planet body
                    const r = 1.5;
                    const phi = Math.random() * Math.PI * 2;
                    const theta = Math.random() * Math.PI;
                    arr[i*3] = r * Math.sin(theta) * Math.cos(phi);
                    arr[i*3+1] = r * Math.sin(theta) * Math.sin(phi);
                    arr[i*3+2] = r * Math.cos(theta);
                } else { // Rings
                    const r = 2.5 + Math.random() * 1.5;
                    const phi = Math.random() * Math.PI * 2;
                    arr[i*3] = r * Math.cos(phi);
                    arr[i*3+1] = (Math.random() - 0.5) * 0.1;
                    arr[i*3+2] = r * Math.sin(phi);
                }
            }
        };

        // Initialize points randomly
        for(let i=0; i<particleCount * 3; i++) {
            positions[i] = (Math.random() - 0.5) * 10;
            colors[i] = Math.random();
        }
        createSphere(targetPositions);
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

        // Animation Logic
        let mouseX = 0, mouseY = 0;
        document.addEventListener('mousemove', (e) => {
            mouseX = (e.clientX - window.innerWidth / 2) / 100;
            mouseY = (e.clientY - window.innerHeight / 2) / 100;
        });

        function animate() {
            requestAnimationFrame(animate);
            
            // Interpolate to target shape
            const posAttr = geometry.attributes.position;
            for(let i=0; i<particleCount * 3; i++) {
                posAttr.array[i] += (targetPositions[i] - posAttr.array[i]) * 0.05;
            }
            posAttr.needsUpdate = true;

            points.rotation.y += 0.002;
            points.rotation.x += (mouseY * 0.05 - points.rotation.x) * 0.1;
            points.rotation.z += (mouseX * 0.05 - points.rotation.z) * 0.1;

            renderer.render(scene, camera);
        }
        animate();

        // --- AUTH LOGIC ---
        let isLogin = true;
        window.toggleMode = () => {
            isLogin = !isLogin;
            const title = document.getElementById('title');
            const fields = document.getElementById('signup-fields');
            const toggleText = document.getElementById('toggleText');

            if(isLogin) {
                title.innerText = 'Sprint Login';
                fields.className = 'hidden';
                toggleText.innerText = 'New to the Sprint? Create an Identity';
                createSphere(targetPositions); // Morph to sphere
                material.color.setHex(0x00f2ff);
            } else {
                title.innerText = 'Join Sprint';
                fields.className = 'visible';
                toggleText.innerText = 'Already Elite? Log In';
                createSaturn(targetPositions); // Morph to Saturn (Growth)
                material.color.setHex(0xff00ff);
            }
        };

        // Handle Window Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Your Firebase Logic remains here...
        window.handleAuth = () => {
            // Add Firebase calls as per your original script
            console.log("Authorizing...");
        };
    </script>
</body>
</html>
